<html>
    <head>
	<script type="text/javascript" src="//unpkg.com/deck.gl@~5.2.0/deckgl.min.js"></script>
	<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/d3/4.13.0/d3.min.js"></script>
    </head>

    <body>
	<div id="container" style="width: 100vw; height: 100vh;"></div>
    </body>
    <script type="text/javascript">
     const DATA_URL = 'data_all.csv';
     d3.csv(DATA_URL,
	    (error, response) => {
		data = response.map(d => [Number(d.x), Number(d.y), d.gene]);
		renderLayer();
	    });
     
     
     function renderLayer () {
	 new deck.DeckGL({
	     views: [new deck.OrbitView({
		 controller: {dragRotate: false}
	     })],
	     viewState: {fov: 50, distance: 10, rotationX: 0, rotationOrbit: 0, zoom: 1},
	     layers: [
		 new deck.ScatterplotLayer({
		     id: 'MERFISH',
		     data: data,
		     coordinateSystem: deck.COORDINATE_SYSTEM.IDENTITY,
		     getPosition: d => [d[0], d[1], 0],
		     getNormal: d => [0, 1, 0],
		     getColor: d => (d[2]==='BRCA2' ? [255, 0, 0, 255] : [0, 0, 0, 100]),
		     getRadius: d => (d[2]==='BRCA2' ? 2 : 1),
		     radiusScale: 0.5,
		     radiusMinPixels: 0.1,
		     radiusMaxPixels: 10,
		     opacity: 1,
		     lightSettings: {
			 coordinateSystem: deck.COORDINATE_SYSTEM.IDENTITY,
			 lightsPosition: [20, 100, 100, 50, 0, 0],
			 lightsStrength: [1, 0, 2, 0],
			 numberOfLights: 2,
			 ambientRatio: 0.2
		     }
		 })
	     ]
	 });
     }     
    </script>

</html>
